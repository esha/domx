/*! domx - v0.13.1 - 2014-11-12
* http://esha.github.io/domx/
* Copyright (c) 2014 ESHA Research; Licensed MIT, GPL */
!function(a,b){"use strict";window.XList=function(a){"number"==typeof a?(this.limit=a,this.add(b.slice(arguments,1))):this.add(arguments)},b={version:"0.13.1",slice:Array.prototype.slice,zero:function(){return 0},nodes:[Element,Text,Comment],lists:[NodeList,HTMLCollection,XList],isList:function(a){return a&&"object"==typeof a&&"length"in a&&!a.nodeType||a instanceof NodeList||a instanceof HTMLCollection},define:function(a,c,d,e){if("string"==typeof c)for(var f=0,g=a.length;g>f;f++)b.defprop(a[f].prototype||a[f],c,d,e);else for(var h in c)b.define(a,h,c[h],d)},defprop:function(a,b,c,d){if(d||!(b in a))try{var e=c.get||c.set?c:{value:c,writable:!0};e.configurable=!0,Object.defineProperty(a,b,e)}catch(f){}},resolve:function(a,c,d,e){var f=a,g=c;if(d=d.length?b.fill(d,e,g):null,f.indexOf(".")>0){for(var h=f.split(".");h.length>1&&(g=g[f=h.shift()]););g=g||c,f=g?h[0]:a}var i=g[f];if(void 0!==i){if("function"==typeof i&&i.apply)return i.apply(g,d);if(!d)return i;g[f]=d[0]}else if(1===c.nodeType){if(!d)return c.getAttribute(a);null===d[0]?c.removeAttribute(a):c.setAttribute(a,d[0])}},fill:function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++){var g=a[e],h=typeof g;d[e]="string"===h?g.replace(/\$\{i\}/g,b):"function"===h?g(c,b,a):g}return d}},b.defprop(a,"_",b),b.define([Node].concat(b.lists),{each:function(a){var c,d,e=b.isList(this)?this:[this],f=[];"string"==typeof a&&(c=b.resolve[a]||a,d=b.slice.call(arguments,1),a=function(a,e){return b.resolve(c,a,d,e)});for(var g,h=0,i=e.length;i>h;h++)g=a.call(e[h],e[h],h,e),(g||c&&void 0!==g)&&f.push(g);return f.length?b.isList(this)?f[0]&&f[0].each?new XList(f):f:f[0]:this},toArray:function(a){if(a=a||[],b.isList(this))for(var c=0,d=this.length;d>c;c++)a.push(this[c]);else a.push(this);return a}}),b.define([XList],{length:0,limit:void 0,add:function(a){var c=this.length;if(arguments.length>1||b.isList(a))for(var d=arguments.length>1?arguments:a,e=0,f=d.length;f>e;e++)this.add(d[e]);else null!==a&&void 0!==a&&this.indexOf(a)<0&&(this[this.length++]=a,this.length===this.limit&&(this.add=b.zero));return this.length-c},isFull:function(){return this.add===b.zero},indexOf:function(a){for(var b=0;b<this.length;b++)if(a===this[b])return b;return-1}}),b.defprop(a,"extend",function(a,c,d,e){Array.isArray(d)||(e=d,d=[Element]),b.define(d,a,c,e),b.define(b.lists,a,function(){var a=arguments;return this.each(function(){return c.apply(this,a)})},e)}),b.parents=[Element,DocumentFragment,a],b.define(b.parents.concat(b.lists),{queryAll:function(a,c){for(var d=b.isList(this)?this:[this],e=new XList(c),f=0,g=d.length;g>f&&(!c||c>e.length);f++)e.add(d[f][c===e.length+1?"querySelector":"querySelectorAll"](a));return e},query:function(a){return this.queryAll(a,1)[0]}}),b.define(b.lists,{only:function(a,b){var c=this.toArray();return c=a>=0||0>a?c.slice(a,b||a+1||void 0):c.filter("function"==typeof a?a:1===arguments.length?function(b){return b[b.matches?"matches":"hasOwnProperty"](a)}:function(c){return(c.each?c.each(a):c[a])===b}),new XList(c)},not:function(){var a=this.only.apply(this,arguments);return this.only(function(b){return a.indexOf(b)<0})}}),b.estFnArgs=function(a,c,d,e){if(c=b.resolve[c]||c,c in a||(e=void 0===d?"boolean"==typeof c?c:!0:d,d=c,c="parentElement"),"boolean"==typeof d&&(e=d,d=null),d){if("string"==typeof d){var f=d;d=function(a){return a.matches&&a.matches(f)}}}else d=function(){return!0};return[c,d,e||!1]},b.define(b.nodes,"farthest",function(a,c,d){var e=b.estFnArgs(this,a,c,d);return b.farthest(this,e[0],e[1],e[2]&&e[1](this)?this:null)}),b.farthest=function(a,c,d,e){return a&&(a=a[c])?b.farthest(a,c,d,d(a)?a:e):e},b.define(b.nodes,"closest",function(a,c,d){var e=b.estFnArgs(this,a,c,d);return e[2]&&e[1](this)?this:b.closest(this,e[0],e[1])}),b.closest=function(a,c,d){return a&&(a=a[c])?d(a)?a:b.closest(a,c,d):null},a.extend("all",function(a,c,d,e){c===!0&&(d=c,c=void 0),e=e||new XList;var f=d?this:this[b.resolve[a]||a];if(f){var g=c&&c.call(this,f,e);null!==g&&e.add(g||f),!f.all||!f.length&&b.isList(f)||f.all(a,c,!1,e)}return e},[Node]);var c=Element.prototype,d="atchesSelector";b.defprop(c,"matches",c.m||c["webkitM"+d]||c["mozM"+d]||c["msM"+d]);var e=b.append={create:function(b,c,d){return e.insert(b,a.createElement(c),d)},insert:function(a,b,c){var d=e.find(a,c);return d?a.insertBefore(b,d):a.appendChild(b),b},find:function(a,b){switch(typeof b){case"string":return a[b]||a.only(b);case"number":return a.children[b];case"object":return b;case"function":return b.call(a,a)}}};a.extend("append",function(a,c){if("string"==typeof a)return e.create(this,a,c);if(b.isList(a)){for(var d=new XList,f=0,g=a.length;g>f;f++)d.add(this.append(a[f],c));return d}return e.insert(this,a,c),a},b.parents),a.extend("remove",function(){var a=this.parentNode;a&&a.removeChild(this)},b.nodes)}(document);