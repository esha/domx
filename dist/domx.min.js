/*! domx - v0.8.0 - 2014-05-13
* http://esha.github.io/domx/
* Copyright (c) 2014 ESHA Research; Licensed MIT, GPL */
!function(a,b){"use strict";window.DOMxList=function(a){"number"==typeof a?(this.limit=a,this.add(b.slice(arguments,1))):this.add(arguments)},b={version:"0.8.0",slice:Array.prototype.slice,noop:function(){},nodes:[Element,Text,Comment],lists:[NodeList,HTMLCollection,DOMxList],isList:function(a){return a&&"object"==typeof a&&"length"in a&&!a.nodeType||a instanceof NodeList||a instanceof HTMLCollection},fn:function(a,c,d){if("string"==typeof c)for(var e=0,f=a.length;f>e;e++)b.define(a[e].prototype||a[e],c,d);else for(var g in c)b.fn(a,g,c[g])},define:function(a,b,c){if(!(b in a))try{var d=c.get||c.set?c:{value:c,writable:!0};d.configurable=!0,Object.defineProperty(a,b,d)}catch(e){}},resolve:function(a,c,d,e){var f=a,g=c;if(d=d.length?b.fill(d,e,g):null,f.indexOf(".")>0){for(var h=f.split(".");h.length>1&&(g=g[f=h.shift()]););g=g||c,f=g?h[0]:a}var i=g[f];if(void 0!==i){if("function"==typeof i&&i.apply)return i.apply(g,d);if(!d)return i;g[f]=d[0]}else{if(!d)return c.getAttribute(a);null===d[0]?c.removeAttribute(a):c.setAttribute(a,d[0])}},fill:function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++){var g=a[e],h=typeof g;d[e]="string"===h?g.replace(/\$\{i\}/g,b):"function"===h?g(c,b,a):g}return d}},b.define(a,"_",b),b.fn(b.nodes.concat(b.lists),{each:function(a){var c,d,e=b.isList(this)?this:[this],f=[];"string"==typeof a&&(c=b.resolve[a]||a,d=b.slice.call(arguments,1),a=function(a,e){return b.resolve(c,a,d,e)});for(var g,h=0,i=e.length;i>h;h++)g=a.call(e[h],e[h],h,e),(g||c&&void 0!==g)&&f.push(g);return f.length?b.isList(this)?f[0].toArray?new DOMxList(f):f:f[0]:this},toArray:function(a){if(a=a||[],b.isList(this))for(var c=0,d=this.length;d>c;c++)a.push(this[c]);else a.push(this);return a}}),b.fn([DOMxList],{length:0,limit:-1,add:function(a){if(arguments.length>1||b.isList(a))for(var c=arguments.length>1?arguments:a,d=0,e=c.length;e>d;d++)this.add(c[d]);else null!==a&&void 0!==a&&this.indexOf(a)<0&&(this[this.length++]=a,this.length===this.limit&&(this.add=b.noop));return this},indexOf:function(a){for(var b=0;b<this.length;b++)if(a===this[b])return b;return-1}}),b.define(a,"extend",function(a,c,d){b.fn(d||[Element],a,c),b.fn(b.lists,a,function(){var a=arguments;return this.each(function(){return c.apply(this,a)})})}),b.parents=[Element,DocumentFragment,a],b.fn(b.parents.concat(b.lists),{queryAll:function(a,c){for(var d=b.isList(this)?this:[this],e=new DOMxList(c),f=0,g=d.length;g>f&&(!c||c>e.length);f++)e.add(d[f][c===e.length+1?"querySelector":"querySelectorAll"](a));return e},query:function(a){return this.queryAll(a,1)[0]}}),b.fn(b.lists,"only",function(a,b){var c=this.toArray(),d=a>=0||0>a,e=1===arguments.length;return c=d?c.slice(a,b||a+1||void 0):c.filter("function"==typeof a?a:e?function(b){return b.matches(a)}:function(c){return c.each(a)===b}),d&&e?c[0]:new DOMxList(c)}),a.extend("all",function(a,c,d){for(var e=d||new DOMxList,f=c?this:this[a];f;)e.add(f),f=b.isList(f)?f.all(a,0,e)&&0:f[a];return e},[Node]);var c=Element.prototype,d="atchesSelector";b.define(c,"matches",c.m||c["webkitM"+d]||c["mozM"+d]||c["msM"+d]);var e=b.add={create:function(b,c,d){return e.insert(b,a.createElement(c),d)},insert:function(a,b,c){var d=e.find(a,c);return d?a.insertBefore(b,d):a.appendChild(b),b},find:function(a,b){switch(typeof b){case"string":return a[b+"Child"];case"number":return a.children[b];case"object":return b;case"function":return b.call(a,a)}}};a.extend("add",function(a,c){if("string"==typeof a)return e.create(this,a,c);if(b.isList(a)){for(var d=new DOMxList,f=0,g=a.length;g>f;f++)d.add(this.add(a[f],c));return d}return e.insert(this,a,c),a},b.parents),a.extend("remove",function(){var a=this.parentNode;a&&a.removeChild(this)},b.nodes),b.fn(b.nodes,"value",{get:function(){var a=(b.get[this.tagName]||b.get).call(this,this);if(a)try{a=JSON.parse(a)}catch(c){}return a},set:function(a){if(a&&"string"!=typeof a)try{a=JSON.stringify(a)}catch(c){}return(b.set[this.tagName]||b.set).call(this,this,a)}}),b.get=function(a){return a.nodeValue||(a.hasAttribute&&a.hasAttribute("value")?a.getAttribute("value"):a.children&&a.children.length?a.innerHTML:a.textContent)},b.set=function(a,b){a.hasAttribute?a.hasAttribute("value")?a.setAttribute("value",b):b&&"<"===b.trim().charAt(0)?a.innerHTML=b:a.textContent=b:a.nodeValue=b};var f=b.repeat={id:"data-repeat-id",count:0,init:function(c,d){var e=c.getAttribute("data-repeat"),g=f.count++,h=e&&a.query(e).cloneNode(!0)||c,i=a.createElement("x-repeat");h.setAttribute(f.id,g),i.setAttribute(f.id,g);for(var j=0,k=c.attributes.length;k>j;j++){var l=c.attributes[j];"data-repeat-none"===l.name&&(i.value=l.value||c.innerHTML),i.setAttribute(l.name,l.value)}return c.parentNode.insertBefore(i,c),b.define(i,"source",h),d!==!0&&c.remove(),g},repeat:function(a,b,c,d){var e=c.cloneNode(!0);return void 0!==d&&null!==d&&(e.value=d),a.insertBefore(e,b),e},style:a.head.add("style")};a.extend("repeat",function(a){var b=this.parentNode,c=this.getAttribute(f.id)||f.init(this,!0),d="["+f.id+'="'+c+'"]',e=d+":not(x-repeat)";if(a===!1)return b.queryAll(e).remove();var g=b.query("x-repeat"+d),h=g.source;g.hasAttribute("data-repeat-first")&&(g=b.query(d+"[data-index]")||g);var i=Array.isArray(a)?a.map(function(a){return f.repeat(b,g,h,a)}):f.repeat(b,g,h,a);return b.queryAll(e).each("setAttribute","data-index","${i}"),i}),f.style.value="[data-repeat] { display: none }",a.addEventListener("DOMContentLoaded",function(){a.queryAll("[data-repeat]").each(f.init),f.style.value="\nx-repeat { display: none }\nx-repeat[data-repeat-none] { display: inline-block; }\n["+f.id+"] + x-repeat[data-repeat-none] { display: none; }"});var g=b.add;g.create=function(b,c,d){var e=c.split(g.emmetRE()),f=a.createDocumentFragment(),h=a.createElement(e[0]);f.appendChild(h);for(var i=1,j=e.length;j>i;i++){var k=e[i];h=g.emmet[k.charAt(0)].call(h,k.substr(1),f)||h}return g.insert(b,f,d),h},g.emmetRE=function(){var a="\\"+Object.keys(g.emmet).join("|\\");return new RegExp("(?="+a+")","g")},g.emmet={"#":function(a){this.id=a},".":function(a){var b=this.getAttribute("class")||"";b=b+(b?" ":"")+a,this.setAttribute("class",b)},"[":function(a){a=a.substr(0,a.length-1).match(/(?:[^\s"]+|"[^"]*")+/g);for(var b=0,c=a.length;c>b;b++){var d=a[b].split("=");this.setAttribute(d[0],(d[1]||"").replace(/"/g,""))}},">":function(b){if(b){var c=a.createElement(b);return this.appendChild(c),c}return this},"+":function(a,b){return g.emmet[">"].call(this.parentNode||b,a)},"*":function(a){for(var b=this.parentNode,c=new DOMxList(this),d=1;a>d;d++)c.add(this.cloneNode(!0)),b.appendChild(c[d]);return c},"^":function(a,b){return g.emmet["+"].call(this.parentNode||b,a,b)},"{":function(b){this.appendChild(a.createTextNode(b.substr(0,b.length-1)))}};var h=b.elements={protos:[Element,DocumentFragment].concat(b.lists),read:function(b){for(var c=0;b&&c<b.children.length;c++){var d=b.children[c],e=d.tagName.toLowerCase();e in a.head||h.fn(e,"children","tagName",d.tagName),h.read(d)}},fn:function(a,c,d,e){b.fn(h.protos,a,{get:function(){return this.each(c).only(d,e)}})}};h.fn("$text","childNodes","nodeType",3),h.fn("$comment","childNodes","nodeType",8),b.define(a,"html",a.documentElement),h.read(a.head),h.read(a.body),a.addEventListener("DOMContentLoaded",function(){h.read(a.body),window.MutationObserver&&new MutationObserver(function(a){for(var b=0,c=a.length;c>b;b++)h.read(a[b].target)}).observe(a.body,{childList:!0,subtree:!0})})}(document);